# Gambling Detection Rules
# Created: 2024
# Author: Your Name

# Import lists
var GAMBLING_DOMAINS "domains.lst"
var GAMBLING_KEYWORDS "keywords.lst"

# URL Pattern Detection
alert http $HOME_NET any -> $EXTERNAL_NET any (
    msg:"GAMBLING URL ACCESS";
    flow:established,to_server;
    pcre:"/{GAMBLING_KEYWORDS}/i";
    http_uri;
    classtype:policy-violation;
    sid:9000001;
    rev:1;
    metadata:
        created 2024-01-01,
        updated 2024-11-12;
)

# SNI Detection
alert tls $HOME_NET any -> $EXTERNAL_NET any (
    msg:"GAMBLING SNI DETECTED";
    flow:established,to_server;
    tls.sni;
    dataset:isset,GAMBLING_DOMAINS;
    classtype:policy-violation;
    sid:9000002;
    rev:1;
)

# HTTP Host Header Detection
alert http $HOME_NET any -> $EXTERNAL_NET any (
    msg:"GAMBLING HOST DETECTED";
    flow:established,to_server;
    http.host;
    dataset:isset,GAMBLING_DOMAINS;
    classtype:policy-violation;
    sid:9000003;
    rev:1;
)

# POST Data Detection
alert http $HOME_NET any -> $EXTERNAL_NET any (
    msg:"GAMBLING POST DATA";
    flow:established,to_server;
    http.method; content:"POST";
    pcre:"/{GAMBLING_KEYWORDS}/i";
    http_client_body;
    classtype:policy-violation;
    sid:9000004;
    rev:1;
)
